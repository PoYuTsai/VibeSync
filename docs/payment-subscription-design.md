# æ”¯ä»˜èˆ‡è¨‚é–±ç³»çµ±è¨­è¨ˆ

## Part 1: å¹£åˆ¥ç­–ç•¥

### æ±ºç­–ï¼šé¡¯ç¤º TWDï¼Œå¾Œç«¯ç”¨ USD

| å±¤é¢ | å¹£åˆ¥ | åŸå›  |
|------|------|------|
| App å…§é¡¯ç¤º | TWD | å°ç£ç”¨æˆ¶ç¿’æ…£ |
| App Store å®šåƒ¹ | USD (Tier) | Apple çµ±ä¸€ç”¨ Tier |
| RevenueCat è¨­å®š | USD | çµ±ä¸€ç®¡ç† |
| è²¡å‹™å ±è¡¨ | USD | åœ‹éš›åŒ–æº–å‚™ |

### App Store åƒ¹æ ¼å°ç…§ (Tier)

| æˆ‘å€‘å®šåƒ¹ | App Store Tier | å¯¦éš› TWD | å¯¦éš› USD |
|----------|----------------|----------|----------|
| NT$99 | Tier 3 | NT$100 | $2.99 |
| NT$249 | Tier 8 | NT$250 | $7.99 |
| NT$499 | Tier 15 | NT$490 | $14.99 |

> App Store æœ‰å›ºå®š Tierï¼Œç„¡æ³•è‡ªè¨‚é‡‘é¡ã€‚é¸æœ€æ¥è¿‘çš„ã€‚

### æœ€çµ‚å®šåƒ¹

| æ–¹æ¡ˆ | é¡¯ç¤ºåƒ¹æ ¼ | App Store Tier | å¯¦æ”¶ (USD) |
|------|----------|----------------|------------|
| **Starter** | NT$100/æœˆ | Tier 3 | $2.99 |
| **Pro** | NT$250/æœˆ | Tier 8 | $7.99 |
| **Business** | NT$490/æœˆ | Tier 15 | $14.99 |

---

## Part 2: æ”¯ä»˜æµç¨‹è¨­è¨ˆ

### æ ¸å¿ƒåŸå‰‡ï¼šæˆ‘å€‘æ°¸ä¸æ¥è§¸ä¿¡ç”¨å¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ”¯ä»˜è³‡æ–™æµå‘                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   ç”¨æˆ¶                                                          â”‚
â”‚    â”‚                                                            â”‚
â”‚    â”‚ 1. é»æ“Šã€Œå‡ç´š Proã€                                        â”‚
â”‚    â–¼                                                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                               â”‚
â”‚   â”‚  VibeSync   â”‚  â† æˆ‘å€‘çš„ App                                 â”‚
â”‚   â”‚    App      â”‚  â† ä¸è™•ç†ä»»ä½•æ”¯ä»˜è³‡è¨Š                         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                               â”‚
â”‚          â”‚                                                      â”‚
â”‚          â”‚ 2. å‘¼å« RevenueCat SDK                               â”‚
â”‚          â–¼                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                               â”‚
â”‚   â”‚ RevenueCat  â”‚  â† è¨‚é–±ç®¡ç†å¹³å°                               â”‚
â”‚   â”‚    SDK      â”‚  â† è™•ç†è¨‚é–±é‚è¼¯                               â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                               â”‚
â”‚          â”‚                                                      â”‚
â”‚          â”‚ 3. è§¸ç™¼åŸç”Ÿæ”¯ä»˜ç•«é¢                                  â”‚
â”‚          â–¼                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚   â”‚ App Store   â”‚ or  â”‚ Google Play â”‚  â† å¹³å°è™•ç†æ”¯ä»˜           â”‚
â”‚   â”‚  æ”¯ä»˜ç•«é¢   â”‚     â”‚   æ”¯ä»˜ç•«é¢  â”‚  â† ä¿¡ç”¨å¡è³‡è¨Šåœ¨é€™è£¡       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚          â”‚                   â”‚                                  â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚                    â”‚                                            â”‚
â”‚                    â”‚ 4. æ”¯ä»˜å®Œæˆï¼Œå›å‚³æ”¶æ“š                      â”‚
â”‚                    â–¼                                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚   â”‚          RevenueCat Server          â”‚                       â”‚
â”‚   â”‚  â€¢ é©—è­‰æ”¶æ“š                         â”‚                       â”‚
â”‚   â”‚  â€¢ æ›´æ–°è¨‚é–±ç‹€æ…‹                     â”‚                       â”‚
â”‚   â”‚  â€¢ Webhook é€šçŸ¥æˆ‘å€‘                 â”‚                       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                      â”‚                                          â”‚
â”‚                      â”‚ 5. Webhook: è¨‚é–±ç‹€æ…‹æ›´æ–°                 â”‚
â”‚                      â–¼                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚   â”‚          Supabase                    â”‚                       â”‚
â”‚   â”‚  â€¢ æ›´æ–° subscriptions è¡¨            â”‚                       â”‚
â”‚   â”‚  â€¢ é‡ç½®é»æ•¸                         â”‚                       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ’³ ä¿¡ç”¨å¡è³‡è¨Šåªåœ¨ Apple/Google çš„ç³»çµ±ä¸­
   æˆ‘å€‘å®Œå…¨ä¸ç¶“æ‰‹ = ç„¡ PCI-DSS åˆè¦è² æ“”
```

### æˆ‘å€‘éœ€è¦è™•ç†çš„ vs ä¸éœ€è¦è™•ç†çš„

| é …ç›® | æˆ‘å€‘è™•ç†ï¼Ÿ | èª°è™•ç†ï¼Ÿ |
|------|-----------|----------|
| ä¿¡ç”¨å¡è™Ÿç¢¼ | âŒ æ°¸ä¸ | Apple/Google |
| ä¿¡ç”¨å¡é©—è­‰ | âŒ æ°¸ä¸ | Apple/Google |
| æ‰£æ¬¾ | âŒ æ°¸ä¸ | Apple/Google |
| é€€æ¬¾ | âŒ æ°¸ä¸ | Apple/Google |
| æ”¶æ“šé©—è­‰ | âš ï¸ é–“æ¥ | RevenueCat |
| è¨‚é–±ç‹€æ…‹ | âœ… æ˜¯ | æˆ‘å€‘ + RevenueCat |
| é»æ•¸ç®¡ç† | âœ… æ˜¯ | æˆ‘å€‘ |
| ç”¨é‡è¿½è¹¤ | âœ… æ˜¯ | æˆ‘å€‘ |

---

## Part 3: Paywall UI/UX è¨­è¨ˆ

### 3.1 è§¸ç™¼ Paywall çš„æ™‚æ©Ÿ

```
å ´æ™¯ 1: é»æ•¸ç”¨å®Œ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                 â”‚
â”‚   ğŸ˜¢ ä»Šæ—¥é»æ•¸å·²ç”¨å®Œ              â”‚
â”‚                                 â”‚
â”‚   å‡ç´šæ–¹æ¡ˆç²å¾—æ›´å¤šåˆ†ææ¬¡æ•¸       â”‚
â”‚                                 â”‚
â”‚   [æŸ¥çœ‹æ–¹æ¡ˆ]    [æ˜å¤©å†ä¾†]      â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å ´æ™¯ 2: å˜—è©¦ä½¿ç”¨ä»˜è²»åŠŸèƒ½
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                 â”‚
â”‚   ğŸ”’ å…±é³´å›è¦†æ˜¯ Starter åŠŸèƒ½     â”‚
â”‚                                 â”‚
â”‚   å‡ç´šå³å¯è§£é–æ‰€æœ‰å›è¦†é¡å‹       â”‚
â”‚                                 â”‚
â”‚   [å‡ç´š Starter NT$100/æœˆ]      â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å ´æ™¯ 3: è¨­å®šé ä¸»å‹•æŸ¥çœ‹
ç”¨æˆ¶ä¸»å‹•é»æ“Šã€Œå‡ç´šæ–¹æ¡ˆã€
```

### 3.2 Paywall ä¸»ç•«é¢

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â†                                      â”‚
â”‚                                         â”‚
â”‚           ğŸš€ å‡ç´šä½ çš„é«”é©—               â”‚
â”‚                                         â”‚
â”‚     è§£é–å®Œæ•´åŠŸèƒ½ï¼Œæå‡å°è©±å“è³ª          â”‚
â”‚                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚         STARTER                 â”‚   â”‚
â”‚  â”‚         NT$100/æœˆ               â”‚   â”‚
â”‚  â”‚                                 â”‚   â”‚
â”‚  â”‚  âœ“ 30 é»/æœˆ                    â”‚   â”‚
â”‚  â”‚  âœ“ æ¯æ—¥ 5 æ¬¡åˆ†æ               â”‚   â”‚
â”‚  â”‚  âœ“ å…¨éƒ¨å›è¦†é¡å‹                â”‚   â”‚
â”‚  â”‚  âœ“ Needy è­¦ç¤º                  â”‚   â”‚
â”‚  â”‚                                 â”‚   â”‚
â”‚  â”‚      [ é¸æ“‡ Starter ]          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â­ PRO          æœ€å—æ­¡è¿       â”‚   â”‚
â”‚  â”‚         NT$250/æœˆ               â”‚   â”‚
â”‚  â”‚                                 â”‚   â”‚
â”‚  â”‚  âœ“ 100 é»/æœˆ                   â”‚   â”‚
â”‚  â”‚  âœ“ æ¯æ—¥ 15 æ¬¡åˆ†æ              â”‚   â”‚
â”‚  â”‚  âœ“ å…¨éƒ¨å›è¦†é¡å‹                â”‚   â”‚
â”‚  â”‚  âœ“ Needy è­¦ç¤º                  â”‚   â”‚
â”‚  â”‚  âœ“ Sonnet æ¨¡å‹å„ªå…ˆ             â”‚   â”‚
â”‚  â”‚                                 â”‚   â”‚
â”‚  â”‚      [ é¸æ“‡ Pro ]              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚         BUSINESS                â”‚   â”‚
â”‚  â”‚         NT$490/æœˆ               â”‚   â”‚
â”‚  â”‚                                 â”‚   â”‚
â”‚  â”‚  âœ“ 250 é»/æœˆ                   â”‚   â”‚
â”‚  â”‚  âœ“ æ¯æ—¥ 30 æ¬¡åˆ†æ              â”‚   â”‚
â”‚  â”‚  âœ“ å…¨éƒ¨åŠŸèƒ½                    â”‚   â”‚
â”‚  â”‚  âœ“ å„ªå…ˆå®¢æœ                    â”‚   â”‚
â”‚  â”‚                                 â”‚   â”‚
â”‚  â”‚      [ é¸æ“‡ Business ]         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                         â”‚
â”‚       7 å¤©å…è²»è©¦ç”¨ï¼Œéš¨æ™‚å–æ¶ˆ            â”‚
â”‚                                         â”‚
â”‚  è¨‚é–±å°‡è‡ªå‹•çºŒç´„ï¼Œå¯åœ¨è¨­å®šä¸­ç®¡ç†         â”‚
â”‚  [ä½¿ç”¨æ¢æ¬¾]  [éš±ç§æ¬Šæ”¿ç­–]  [æ¢å¾©è³¼è²·]  â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 è³¼è²·ç¢ºèªæµç¨‹

```
ç”¨æˆ¶é»æ“Šã€Œé¸æ“‡ Proã€
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         â”‚
â”‚   ç¢ºèªè¨‚é–± Pro æ–¹æ¡ˆï¼Ÿ                   â”‚
â”‚                                         â”‚
â”‚   NT$250/æœˆ                             â”‚
â”‚   é¦–æ¬¡è¨‚é–±äº« 7 å¤©å…è²»è©¦ç”¨               â”‚
â”‚                                         â”‚
â”‚   â€¢ è©¦ç”¨æœŸé–“å¯éš¨æ™‚å–æ¶ˆ                  â”‚
â”‚   â€¢ è©¦ç”¨çµæŸå¾Œè‡ªå‹•æ‰£æ¬¾                  â”‚
â”‚   â€¢ å¯åœ¨ App Store ç®¡ç†è¨‚é–±             â”‚
â”‚                                         â”‚
â”‚   [å–æ¶ˆ]        [ç¢ºèªè¨‚é–±]              â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ ç”¨æˆ¶ç¢ºèª
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         â”‚
â”‚        [ iOS åŸç”Ÿæ”¯ä»˜ç•«é¢ ]             â”‚
â”‚                                         â”‚
â”‚   ä½¿ç”¨ Face ID ç¢ºèªè³¼è²·                 â”‚
â”‚                                         â”‚
â”‚   Pro è¨‚é–±                              â”‚
â”‚   NT$250/æœˆ                             â”‚
â”‚   7 å¤©å…è²»è©¦ç”¨                          â”‚
â”‚                                         â”‚
â”‚         [Face ID åœ–ç¤º]                  â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ Face ID / å¯†ç¢¼é©—è­‰
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         â”‚
â”‚           ğŸ‰ è¨‚é–±æˆåŠŸï¼                 â”‚
â”‚                                         â”‚
â”‚   æ­¡è¿æˆç‚º Pro æœƒå“¡                     â”‚
â”‚                                         â”‚
â”‚   â€¢ 100 é»å·²åŠ å…¥å¸³æˆ¶                   â”‚
â”‚   â€¢ æ‰€æœ‰åŠŸèƒ½å·²è§£é–                      â”‚
â”‚   â€¢ è©¦ç”¨æœŸè‡³ 2026/03/05                â”‚
â”‚                                         â”‚
â”‚          [é–‹å§‹ä½¿ç”¨]                     â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.4 è¨‚é–±ç®¡ç†ç•«é¢ (è¨­å®šå…§)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† è¨‚é–±ç®¡ç†                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  ç›®å‰æ–¹æ¡ˆ                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â­ PRO                         â”‚   â”‚
â”‚  â”‚                                 â”‚   â”‚
â”‚  â”‚  NT$250/æœˆ                      â”‚   â”‚
â”‚  â”‚  ä¸‹æ¬¡æ‰£æ¬¾ï¼š2026/03/26           â”‚   â”‚
â”‚  â”‚                                 â”‚   â”‚
â”‚  â”‚  æœ¬æœˆé»æ•¸ï¼š67/100 å‰©é¤˜          â”‚   â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘        â”‚   â”‚
â”‚  â”‚                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                         â”‚
â”‚  [å‡ç´šè‡³ Business]                      â”‚
â”‚                                         â”‚
â”‚  [åŠ è³¼é»æ•¸]  20é» NT$60                â”‚
â”‚                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                         â”‚
â”‚  [ç®¡ç†è¨‚é–±]  â†’ é–‹å•Ÿ App Store è¨­å®š     â”‚
â”‚                                         â”‚
â”‚  [æ¢å¾©è³¼è²·]  æ›æ©Ÿæˆ–é‡è£å¾Œé»æ­¤           â”‚
â”‚                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                         â”‚
â”‚  ğŸ“§ æ”¶æ“šå°‡å¯„è‡³: user@example.com        â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Part 4: æ¯æ—¥é™åˆ¶è¨­è¨ˆ

### ç‚ºä»€éº¼éœ€è¦æ¯æ—¥é™åˆ¶ï¼Ÿ

| é¢¨éšª | æ²’æœ‰é™åˆ¶ | æœ‰é™åˆ¶ |
|------|----------|--------|
| ä¸€å¤©ç”¨å®Œæœˆé»æ•¸ | å¯èƒ½ | ä¸å¯èƒ½ |
| API æˆæœ¬å°–å³° | ç„¡æ³•é æ¸¬ | å¯æ§ |
| æ¿«ç”¨åµæ¸¬ | å›°é›£ | ç°¡å–® |
| ç”¨æˆ¶é«”é©— | æœˆåº•æ²’é»æ•¸ | æ¯å¤©éƒ½èƒ½ç”¨ |

### æ¯æ—¥é™åˆ¶é…ç½®

| æ–¹æ¡ˆ | æœˆé»æ•¸ | æ¯æ—¥ä¸Šé™ | è¨­è¨ˆé‚è¼¯ |
|------|--------|----------|----------|
| Free | 5 | 3 | é«”é©—ç”¨ï¼Œå¼•å°å‡ç´š |
| Starter | 30 | 5 | 30Ã·30=1/å¤©ï¼Œçµ¦5æ¬¡ç·©è¡ |
| Pro | 100 | 15 | 100Ã·30â‰ˆ3/å¤©ï¼Œçµ¦15æ¬¡é‡åº¦ç”¨ |
| Business | 250 | 30 | 250Ã·30â‰ˆ8/å¤©ï¼Œçµ¦30æ¬¡é«˜å³° |

### UI æç¤ºè¨­è¨ˆ

```
æƒ…æ³ 1: æ¥è¿‘æ¯æ—¥ä¸Šé™
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš ï¸ ä»Šæ—¥å‰©é¤˜ 2 æ¬¡åˆ†æ                   â”‚
â”‚     æ˜æ—¥ 00:00 é‡ç½®                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æƒ…æ³ 2: é”åˆ°æ¯æ—¥ä¸Šé™
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         â”‚
â”‚   ğŸ˜´ ä»Šæ—¥åˆ†ææ¬¡æ•¸å·²é”ä¸Šé™               â”‚
â”‚                                         â”‚
â”‚   Pro æ–¹æ¡ˆæ¯æ—¥å¯åˆ†æ 15 æ¬¡              â”‚
â”‚   ä½ ä»Šå¤©å·²ç¶“å¾ˆåŠªåŠ›äº†ï¼                  â”‚
â”‚                                         â”‚
â”‚   æ˜æ—¥ 00:00 é‡ç½®                       â”‚
â”‚                                         â”‚
â”‚   [å‡ç´š Business æé«˜ä¸Šé™]              â”‚
â”‚   [è¨­å®šæé†’æ˜å¤©å†ä¾†]                    â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æƒ…æ³ 3: æœˆé»æ•¸ç”¨å®Œä½†é‚„æœ‰æ¯æ—¥æ¬¡æ•¸
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         â”‚
â”‚   ğŸ“¦ æœ¬æœˆé»æ•¸å·²ç”¨å®Œ                     â”‚
â”‚                                         â”‚
â”‚   ä¸‹æ¬¡é‡ç½®ï¼š2026/03/01                  â”‚
â”‚                                         â”‚
â”‚   [åŠ è³¼ 20 é» NT$60]                   â”‚
â”‚   [å‡ç´šæ–¹æ¡ˆç²å¾—æ›´å¤š]                    â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Part 5: è³‡æ–™åº«è¨­è¨ˆæ›´æ–°

### subscriptions è¡¨æ›´æ–°

```sql
CREATE TABLE subscriptions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES users(id) ON DELETE CASCADE UNIQUE,

  -- æ–¹æ¡ˆè³‡è¨Š
  tier TEXT NOT NULL DEFAULT 'free'
    CHECK (tier IN ('free', 'starter', 'pro', 'business')),
  status TEXT NOT NULL DEFAULT 'active'
    CHECK (status IN ('active', 'trialing', 'expired', 'cancelled')),

  -- RevenueCat æ•´åˆ
  rc_customer_id TEXT,
  rc_entitlement_id TEXT,
  rc_product_id TEXT,

  -- é»æ•¸ç®¡ç†
  monthly_credits INTEGER NOT NULL DEFAULT 5,      -- æœˆé…é¡
  credits_used INTEGER NOT NULL DEFAULT 0,          -- æœ¬æœˆå·²ç”¨
  credits_reset_at TIMESTAMPTZ DEFAULT NOW(),       -- é»æ•¸é‡ç½®æ™‚é–“

  -- æ¯æ—¥é™åˆ¶
  daily_limit INTEGER NOT NULL DEFAULT 3,           -- æ¯æ—¥ä¸Šé™
  daily_used INTEGER NOT NULL DEFAULT 0,            -- ä»Šæ—¥å·²ç”¨
  daily_reset_at TIMESTAMPTZ DEFAULT NOW(),         -- æ¯æ—¥é‡ç½®æ™‚é–“

  -- åŠ è³¼é»æ•¸ (ä¸é‡ç½®)
  bonus_credits INTEGER NOT NULL DEFAULT 0,

  -- æ™‚é–“æˆ³è¨˜
  trial_ends_at TIMESTAMPTZ,
  current_period_ends_at TIMESTAMPTZ,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- æ–¹æ¡ˆé…ç½®
CREATE TABLE subscription_tiers (
  tier TEXT PRIMARY KEY,
  monthly_credits INTEGER NOT NULL,
  daily_limit INTEGER NOT NULL,
  price_display TEXT NOT NULL,      -- é¡¯ç¤ºç”¨ "NT$250/æœˆ"
  price_usd DECIMAL(10,2) NOT NULL, -- å¯¦éš›ç¾é‡‘
  features JSONB NOT NULL           -- åŠŸèƒ½æ¸…å–®
);

INSERT INTO subscription_tiers VALUES
  ('free', 5, 3, 'NT$0', 0, '{"extend": true, "resonate": false, "tease": false, "needy_alert": false}'),
  ('starter', 30, 5, 'NT$100/æœˆ', 2.99, '{"extend": true, "resonate": true, "tease": true, "needy_alert": true}'),
  ('pro', 100, 15, 'NT$250/æœˆ', 7.99, '{"extend": true, "resonate": true, "tease": true, "needy_alert": true, "sonnet_priority": true}'),
  ('business', 250, 30, 'NT$490/æœˆ', 14.99, '{"extend": true, "resonate": true, "tease": true, "needy_alert": true, "sonnet_priority": true, "priority_support": true}');
```

### é»æ•¸æª¢æŸ¥é‚è¼¯

```typescript
interface UsageCheck {
  canAnalyze: boolean;
  reason?: 'daily_limit' | 'monthly_limit' | 'no_credits';
  remainingDaily: number;
  remainingMonthly: number;
  resetTime?: Date;
}

async function checkUsage(userId: string): Promise<UsageCheck> {
  const sub = await getSubscription(userId);

  // æª¢æŸ¥æ¯æ—¥é‡ç½®
  if (isNewDay(sub.daily_reset_at)) {
    await resetDailyUsage(userId);
    sub.daily_used = 0;
  }

  // æª¢æŸ¥æœˆåº¦é‡ç½®
  if (isNewMonth(sub.credits_reset_at)) {
    await resetMonthlyUsage(userId);
    sub.credits_used = 0;
  }

  const remainingDaily = sub.daily_limit - sub.daily_used;
  const remainingMonthly = (sub.monthly_credits + sub.bonus_credits) - sub.credits_used;

  // æª¢æŸ¥æ¯æ—¥é™åˆ¶
  if (remainingDaily <= 0) {
    return {
      canAnalyze: false,
      reason: 'daily_limit',
      remainingDaily: 0,
      remainingMonthly,
      resetTime: getNextMidnight(),
    };
  }

  // æª¢æŸ¥æœˆåº¦é»æ•¸
  if (remainingMonthly <= 0) {
    return {
      canAnalyze: false,
      reason: 'monthly_limit',
      remainingDaily,
      remainingMonthly: 0,
      resetTime: getNextMonthStart(),
    };
  }

  return {
    canAnalyze: true,
    remainingDaily,
    remainingMonthly,
  };
}
```

---

## Part 6: RevenueCat æ•´åˆ

### Webhook è¨­å®š

```typescript
// supabase/functions/revenuecat-webhook/index.ts

interface RevenueCatEvent {
  event_type: 'INITIAL_PURCHASE' | 'RENEWAL' | 'CANCELLATION' | 'EXPIRATION';
  app_user_id: string;
  product_id: string;
  entitlement_id: string;
}

serve(async (req) => {
  const event: RevenueCatEvent = await req.json();

  switch (event.event_type) {
    case 'INITIAL_PURCHASE':
    case 'RENEWAL':
      // è¨‚é–±é–‹å§‹/çºŒç´„
      await activateSubscription(event);
      break;

    case 'CANCELLATION':
      // å–æ¶ˆ (ä½†é‚„åœ¨æœ‰æ•ˆæœŸå…§)
      await markCancelled(event);
      break;

    case 'EXPIRATION':
      // çœŸæ­£éæœŸ
      await expireSubscription(event);
      break;
  }

  return new Response('OK');
});

async function activateSubscription(event: RevenueCatEvent) {
  const tier = productIdToTier(event.product_id);
  const tierConfig = await getTierConfig(tier);

  await supabase
    .from('subscriptions')
    .update({
      tier,
      status: 'active',
      monthly_credits: tierConfig.monthly_credits,
      daily_limit: tierConfig.daily_limit,
      credits_used: 0,  // é‡ç½®é»æ•¸
      daily_used: 0,
      credits_reset_at: new Date(),
      rc_product_id: event.product_id,
      rc_entitlement_id: event.entitlement_id,
    })
    .eq('rc_customer_id', event.app_user_id);
}

async function expireSubscription(event: RevenueCatEvent) {
  // é™ç´šåˆ° Free
  await supabase
    .from('subscriptions')
    .update({
      tier: 'free',
      status: 'expired',
      monthly_credits: 5,
      daily_limit: 3,
    })
    .eq('rc_customer_id', event.app_user_id);
}
```

---

## Part 7: å®Œæ•´æµç¨‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ¶è¨‚é–±ç”Ÿå‘½é€±æœŸ                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  æ–°ç”¨æˆ¶è¨»å†Š                                                             â”‚
â”‚      â”‚                                                                  â”‚
â”‚      â–¼                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚
â”‚  â”‚  Free   â”‚ â”€â”€â”€â”€ ä½¿ç”¨ 5 æ¬¡ â”€â”€â”€â”€ ç”¨å®Œ â”€â”€â”€â”€ çœ‹åˆ° Paywall                â”‚
â”‚  â”‚  5é»/æœˆ â”‚                              â”‚                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚                             â”‚
â”‚                                           â–¼                             â”‚
â”‚                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                               â”‚   é¸æ“‡ä»˜è²»æ–¹æ¡ˆ    â”‚                     â”‚
â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                         â”‚                               â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚      â”‚                                  â”‚                       â”‚       â”‚
â”‚      â–¼                                  â–¼                       â–¼       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Starter â”‚                      â”‚   Pro   â”‚              â”‚Business â”‚  â”‚
â”‚  â”‚ 30é»/æœˆ â”‚                      â”‚ 100é»/æœˆâ”‚              â”‚250é»/æœˆ â”‚  â”‚
â”‚  â”‚ 5æ¬¡/å¤©  â”‚                      â”‚ 15æ¬¡/å¤© â”‚              â”‚30æ¬¡/å¤©  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â”‚
â”‚       â”‚                                â”‚                        â”‚       â”‚
â”‚       â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚       â”‚         â”‚                      â”‚                                â”‚
â”‚       â–¼         â–¼                      â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚                    æ­£å¸¸ä½¿ç”¨                              â”‚            â”‚
â”‚  â”‚                                                         â”‚            â”‚
â”‚  â”‚   æ¯æ¬¡åˆ†æ:                                             â”‚            â”‚
â”‚  â”‚   1. æª¢æŸ¥æ¯æ—¥é™åˆ¶ â†’ è¶…éå‰‡æç¤ºæ˜å¤©å†ä¾†                  â”‚            â”‚
â”‚  â”‚   2. æª¢æŸ¥æœˆé»æ•¸ â†’ è¶…éå‰‡æç¤ºåŠ è³¼æˆ–ç­‰ä¸‹æœˆ                â”‚            â”‚
â”‚  â”‚   3. æ‰£é™¤é»æ•¸ (1-3é»ä¾è¤‡é›œåº¦)                          â”‚            â”‚
â”‚  â”‚   4. è¨˜éŒ„ä½¿ç”¨                                           â”‚            â”‚
â”‚  â”‚                                                         â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚       â”‚                                                                 â”‚
â”‚       â”‚ æ¯æœˆè‡ªå‹•çºŒç´„                                                    â”‚
â”‚       â”‚                                                                 â”‚
â”‚       â–¼                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚  â”‚  çºŒç´„æˆåŠŸ       â”‚      â”‚  çºŒç´„å¤±æ•—       â”‚                          â”‚
â”‚  â”‚  é»æ•¸é‡ç½®       â”‚      â”‚  (ä¿¡ç”¨å¡å•é¡Œ)   â”‚                          â”‚
â”‚  â”‚  ç¹¼çºŒä½¿ç”¨       â”‚      â”‚                 â”‚                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                                    â”‚                                    â”‚
â”‚                                    â–¼                                    â”‚
â”‚                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                           â”‚  Grace Period   â”‚                          â”‚
â”‚                           â”‚  (7å¤©å¯¬é™æœŸ)    â”‚                          â”‚
â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                                    â”‚                                    â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚                    â”‚                               â”‚                    â”‚
â”‚                    â–¼                               â–¼                    â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚           â”‚  æ›´æ–°ä»˜æ¬¾æˆåŠŸ   â”‚             â”‚  ä»ç„¶å¤±æ•—       â”‚          â”‚
â”‚           â”‚  æ¢å¾©è¨‚é–±       â”‚             â”‚  é™ç´šåˆ° Free    â”‚          â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Part 8: å®‰å…¨è€ƒé‡

### æˆ‘å€‘éœ€è¦ä¿è­·çš„è³‡æ–™

| è³‡æ–™é¡å‹ | æ•æ„Ÿåº¦ | ä¿è­·æ–¹å¼ |
|----------|--------|----------|
| ä¿¡ç”¨å¡è™Ÿ | ğŸ”´ æ¥µé«˜ | **æˆ‘å€‘ä¸ç¶“æ‰‹** |
| ç”¨æˆ¶ Email | ğŸŸ¡ ä¸­ | åŠ å¯†å„²å­˜ |
| è¨‚é–±ç‹€æ…‹ | ğŸŸ¢ ä½ | RLS ä¿è­· |
| é»æ•¸é¤˜é¡ | ğŸŸ¢ ä½ | RLS ä¿è­· |
| å°è©±å…§å®¹ | ğŸ”´ æ¥µé«˜ | æœ¬åœ°åŠ å¯†ï¼Œä¸ä¸Šå‚³ |

### é˜²æ­¢é»æ•¸ä½œå¼Š

```typescript
// æ‰€æœ‰é»æ•¸æ“ä½œéƒ½åœ¨ Server ç«¯

// âŒ çµ•å°ä¸åšï¼šClient ç«¯ç®¡ç†é»æ•¸
// ç”¨æˆ¶å¯ä»¥ä¿®æ”¹æœ¬åœ°è³‡æ–™

// âœ… æ­£ç¢ºåšæ³•ï¼šServer ç«¯é©—è­‰
async function analyzeChat(userId: string, messages: Message[]) {
  // 1. Server æª¢æŸ¥é»æ•¸
  const usage = await checkUsage(userId);
  if (!usage.canAnalyze) {
    throw new Error(usage.reason);
  }

  // 2. å…ˆæ‰£é»æ•¸ (é˜²æ­¢ä¸¦ç™¼è«‹æ±‚)
  await deductCredits(userId, calculateCredits(messages));

  // 3. åŸ·è¡Œåˆ†æ
  try {
    return await callClaudeAPI(messages);
  } catch (error) {
    // 4. å¤±æ•—å‰‡é€€é‚„é»æ•¸
    await refundCredits(userId, calculateCredits(messages));
    throw error;
  }
}
```

### æ”¶æ“šé©—è­‰

```typescript
// RevenueCat å·²è™•ç†æ”¶æ“šé©—è­‰
// ä½†æˆ‘å€‘å¯ä»¥é¡å¤–æª¢æŸ¥

async function verifyPurchase(userId: string) {
  // å¾ RevenueCat å–å¾—æœ€æ–°ç‹€æ…‹
  const customerInfo = await Purchases.getCustomerInfo();

  // æ¯”å°æœ¬åœ°ç‹€æ…‹
  const localSub = await getSubscription(userId);

  if (customerInfo.entitlements.active['pro'] && localSub.tier !== 'pro') {
    // ç‹€æ…‹ä¸ä¸€è‡´ï¼Œæ›´æ–°æœ¬åœ°
    await syncSubscription(userId, customerInfo);
  }
}
```
